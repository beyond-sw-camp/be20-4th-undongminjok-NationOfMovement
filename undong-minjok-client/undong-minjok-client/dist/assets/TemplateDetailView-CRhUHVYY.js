import{_ as h,c,o as r,d as e,t as o,w,I as b,b as m,g as u,J as g,n as y,F as B,A as C,i as M,E as p}from"./index-Cu44W2Vv.js";const T={name:"TemplateBuyModal",props:{templateTitle:String,price:Number},emits:["close","confirm"],methods:{close(){this.$emit("close")},confirmBuy(){this.$emit("confirm")}}},x={class:"modal-box"},L={class:"template-info"},V={class:"template-name"},A={class:"template-price"},I={class:"button-row"};function D(i,t,l,f,s,n){return r(),c("div",{class:"modal-backdrop",onClick:t[2]||(t[2]=w((...a)=>n.close&&n.close(...a),["self"]))},[e("div",x,[t[3]||(t[3]=e("h2",{class:"modal-title"},"í…œí”Œë¦¿ êµ¬ë§¤",-1)),t[4]||(t[4]=e("p",{class:"modal-sub"}," ì´ í…œí”Œë¦¿ì„ êµ¬ë§¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ",-1)),e("div",L,[e("span",V,o(l.templateTitle),1),e("span",A,o(l.price===0?"ë¬´ë£Œ":`â‚©${l.price}`),1)]),e("div",I,[e("button",{class:"cancel-btn",onClick:t[0]||(t[0]=(...a)=>n.close&&n.close(...a))},"ì·¨ì†Œ"),e("button",{class:"buy-btn",onClick:t[1]||(t[1]=(...a)=>n.confirmBuy&&n.confirmBuy(...a))},"êµ¬ë§¤í•˜ê¸°")])])])}const N=h(T,[["render",D],["__scopeId","data-v-c518dca6"]]),S={name:"TemplateDetailView",components:{HeaderBar:b,TemplateBuyModal:N},props:["id"],data(){return{BASE_URL:"http://localhost:8888/uploads/",showBuyModal:!1,liked:!1,likeCount:0,template:{id:null,title:"",creator:"",sellerProfileImg:"",awards:"IFBB ì•„ë§ˆì¶”ì–´ 1ìœ„ Â· êµ­ë‚´ ì±”í”¼ì–¸ì‹­ TOP3 Â· 10ë…„ ê²½ë ¥ PT ì „ë¬¸ê°€",price:0,likes:0,salesCount:0,category:"",structure:"",duration:"",level:"",thumbnail:"",description:"",date:"",isMine:!1},starLevel:""}},computed:{benefitLines(){return this.template.description?this.template.description.split(`
`).map(i=>i.trim()).filter(i=>i.length>0):[]}},async mounted(){await this.fetchTemplateDetail(this.id)},methods:{async fetchTemplateDetail(i){try{const l=(await p.getDetail(i)).data.data;this.template.id=l.id,this.template.title=l.name,this.template.description=l.content,this.template.thumbnail=this.BASE_URL+l.thumbnailImage,this.template.creator=l.writerNickname,this.template.isMine=l.isMine,this.template.price=l.price,this.template.salesCount=l.salesCount,this.template.category=l.category||"",this.template.duration=l.duration||"",this.template.level=l.level||"",this.template.date=l.createdAt?.split("T")[0]||this.template.date,this.likeCount=l.recommendCount||0,this.liked=l.recommended||!1,this.starLevel=this.convertStars(this.template.salesCount)}catch(t){console.error("í…œí”Œë¦¿ ì¡°íšŒ ì˜¤ë¥˜",t)}},convertStars(i){return i<50?"â­":i<150?"â­â­":i<300?"â­â­â­":i<500?"â­â­â­â­":"â­â­â­â­â­"},async toggleLike(){const i=this.liked,t=this.likeCount;this.liked=!this.liked,this.likeCount+=this.liked?1:-1;try{this.liked?await p.recommend(this.template.id):await p.unRecommend(this.template.id)}catch(l){console.error("ì¶”ì²œ/ì·¨ì†Œ ì‹¤íŒ¨",l),this.liked=i,this.likeCount=t}},async purchaseTemplate(){try{if(this.template.isMine){alert("ë³¸ì¸ì´ ë§Œë“  í…œí”Œë¦¿ì€ êµ¬ë§¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),this.showBuyModal=!1;return}const i=this.template.id;await p.purchase(i),alert("êµ¬ë§¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"),this.showBuyModal=!1,this.$router.push("/templates/storage")}catch(i){console.error("êµ¬ë§¤ ì‹¤íŒ¨",i);const t=i.response?.data?.message||i.customMessage||"êµ¬ë§¤ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";alert(t),this.showBuyModal=!1}}}},R={class:"detail-page"},E={class:"top-section"},P={class:"top-left"},F={class:"seller-profile"},H=["src"],z={class:"seller-info"},U={class:"seller-name"},j={class:"like-row"},J={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},O={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},q={class:"like-count"},G={class:"top-right"},K=["src"],Q={class:"bottom-section"},W={class:"bottom-left"},X={class:"benefit-section"},Y={class:"benefit-box"},Z={class:"sell-box"},$={class:"sell-price"},ee=["disabled"],te={class:"sell-meta"},se={class:"info-table"},le={class:"row"},ie={class:"row"},oe={class:"row"};function ne(i,t,l,f,s,n){const a=m("HeaderBar"),_=m("RouterView"),v=m("TemplateBuyModal");return r(),c("div",R,[u(a),u(_),e("section",E,[e("div",P,[e("div",F,[e("img",{class:"profile-img",src:s.template.sellerProfileImg},null,8,H),e("div",z,[e("h2",null,o(s.template.creator),1),e("p",U,o(s.template.awards),1)]),e("div",j,[e("span",{class:"heart-icon",onClick:t[0]||(t[0]=(...d)=>n.toggleLike&&n.toggleLike(...d))},[s.liked?(r(),c("svg",O,[...t[4]||(t[4]=[e("path",{fill:"red",d:"M12 20.25s-9-4.78-9-12A4.76 4.76 0 0 1 7.688 3.75c1.935 0 3.597 1.07 4.312 2.622C12.715 4.82 14.377 3.75 16.312 3.75A4.76 4.76 0 0 1 21 8.25c0 7.22-9 12-9 12z"},null,-1)])])):(r(),c("svg",J,[...t[3]||(t[3]=[e("path",{fill:"none",stroke:"currentColor","stroke-width":"1.8","stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.07-4.312 2.622C11.285 4.82 9.623 3.75 7.688 3.75 5.099 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"},null,-1)])]))]),e("span",q,o(s.likeCount),1)])])]),e("div",G,[e("img",{class:"template-img",src:s.template.thumbnail},null,8,K)])]),e("section",Q,[e("div",W,[e("div",X,[t[6]||(t[6]=e("h3",{class:"benefit-title"},"ìˆ˜ê°• í›„ ì´ëŸ°ê±¸ ì–»ì„ ìˆ˜ ìžˆì–´ìš”",-1)),e("div",Y,[(r(!0),c(B,null,C(n.benefitLines,(d,k)=>(r(),c("div",{class:"benefit-item",key:k},[t[5]||(t[5]=e("span",{class:"check"},"âœ”",-1)),M(" "+o(d),1)]))),128))])])]),e("div",Z,[e("h2",$,o(s.template.price===0?"ë¬´ë£Œ":`â‚©${s.template.price}`),1),e("button",{class:"buy-btn",disabled:s.template.isMine,onClick:t[1]||(t[1]=d=>!s.template.isMine&&(s.showBuyModal=!0))},o(s.template.isMine?"ë‚´ í…œí”Œë¦¿ìž…ë‹ˆë‹¤":"êµ¬ë§¤í•˜ê¸°"),9,ee),e("div",te,[e("p",null,"ðŸ“… ë“±ë¡ë‚ ì§œ: "+o(s.template.date),1),e("p",null,"ðŸ”¥ íŒë§¤ëŸ‰: "+o(s.template.salesCount)+"íšŒ "+o(s.starLevel),1),e("p",null,"â¤ï¸ "+o(s.likeCount),1)]),t[11]||(t[11]=e("hr",{class:"divider"},null,-1)),e("div",se,[e("div",le,[t[7]||(t[7]=e("span",{class:"label"},"ì¹´í…Œê³ ë¦¬",-1)),e("span",null,o(s.template.category),1)]),t[10]||(t[10]=e("div",{class:"row"},[e("span",{class:"label"},"êµ¬ì„±"),e("span",null,"7ì¼ ë¶„í•  ìš´ë™ ë£¨í‹´")],-1)),e("div",ie,[t[8]||(t[8]=e("span",{class:"label"},"ìš´ë™ì‹œê°„",-1)),e("span",null,o(s.template.duration),1)]),e("div",oe,[t[9]||(t[9]=e("span",{class:"label"},"ë‚œì´ë„",-1)),e("span",null,o(s.template.level),1)])]),t[12]||(t[12]=e("div",{class:"notice-box"},"ì´ í…œí”Œë¦¿ì€ ì½”ì¹˜ê°€ ì§ì ‘ ì œìž‘í•˜ì—¬ ì œê³µí•˜ëŠ” ìš´ë™ ë£¨í‹´ìž…ë‹ˆë‹¤.",-1))])]),s.showBuyModal?(r(),g(v,{key:0,templateTitle:s.template.title,price:s.template.price,onClose:t[2]||(t[2]=d=>s.showBuyModal=!1),onConfirm:n.purchaseTemplate},null,8,["templateTitle","price","onConfirm"])):y("",!0)])}const re=h(S,[["render",ne],["__scopeId","data-v-aeff61d0"]]);export{re as default};
